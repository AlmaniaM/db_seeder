---
dist: bionic

sudo: true

jdk:
  - oraclejdk14

env:
  matrix:
    - DB_SEEDER_DBMS=cratedb
    - DB_SEEDER_DBMS=cubrid
    - DB_SEEDER_DBMS=derby
    - DB_SEEDER_DBMS=derby_emb
    - DB_SEEDER_DBMS=firebird
    - DB_SEEDER_DBMS=h2
    - DB_SEEDER_DBMS=h2_emb
    - DB_SEEDER_DBMS=hsqldb
    - DB_SEEDER_DBMS=hsqldb_emb
    - DB_SEEDER_DBMS=ibmdb2
    - DB_SEEDER_DBMS=informix
    - DB_SEEDER_DBMS=mariadb
    - DB_SEEDER_DBMS=mssqlserver
    - DB_SEEDER_DBMS=mysql
    - DB_SEEDER_DBMS=oracle
    - DB_SEEDER_DBMS=postgresql
    - DB_SEEDER_DBMS=sqlite

script:
  # Prepare Installation Process -------------------------------------------------
  - travis_fold start "Prepare_Installation_Process"
  - export VERSION_GRADLE=6.4.1
  - sudo apt update -q
  - travis_fold end   "Prepare_Installation_Process"

  # Install Gradle ---------------------------------------------------------------
  - travis_fold start "Install_Gradle"
  - wget -q https://services.gradle.org/distributions/gradle-${VERSION_GRADLE}-bin.zip -P /tmp
  - sudo unzip -d /opt/gradle /tmp/gradle-*.zip
  - export GRADLE_HOME=/opt/gradle/gradle-${VERSION_GRADLE}
  - export PATH=${GRADLE_HOME}/bin:${PATH}
  - travis_fold end   "Install_Gradle"

  # Pull and Compile the Repository ----------------------------------------------
  - gradle --version
  - java -version
  - travis_fold start "Pull_And_Compile_Repository"
  - git pull
  - sudo chmod +x *.sh
  - gradle copyJarToLib
  - travis_fold end   "Pull_And_Compile_Repository"

  # Setup the DBMS ---------------------------------------------------------------
  - travis_fold start "Setup_DBMS"
  - ./run_db_seeder_setup_dbms.sh ${DB_SEEDER_DBMS} no
  - travis_fold end   "Setup_DBMS"

  # Generate Dummy Data 1st Run --------------------------------------------------
  - travis_fold start "Generate_Dummy_Data"
  - ./run_db_seeder.sh ${DB_SEEDER_DBMS}
  - travis_fold end   "Generate_Dummy_Data"

  # Generate Dummy Data 2nd Run --------------------------------------------------
  - travis_fold start "Generate_Dummy_Data"
  - ./run_db_seeder.sh ${DB_SEEDER_DBMS}
  - travis_fold end   "Generate_Dummy_Data"
